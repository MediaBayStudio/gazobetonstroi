!function(e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():window.MobileMenu=e()}(function(){return MobileMenu=function(e,t){var n=this,o=function(e,t){for(var n in e)void 0===t[n]?t[n]=e[n]:"object"==typeof t[n]&&o(e[n],t[n])};return n.options=t||{},n.selector=e,n.defaults={menuClass:"active",overlayClass:"active",openButtonClass:"active",fakeScrollbarClass:"active",bodyClass:"no-scroll",allowPageScroll:!1,overlayClick:!0,escToClose:!0,toRight:!1,toLeft:!1,fixHeader:"",fixHeaderClass:"fixed",fixHeaderThreshold:0,fade:!1,swipe:!0,swipeThreshold:.3,fakeScrollbar:"#fake-scrollbar"},n.$menu=null,n.$openButton=null,n.$closeButtons=null,n.$overlay=null,n.$fakeScrollbar=null,n.$header=null,n.$headerClone=null,n.$headerParent=null,n.menuWidth=0,n.menuHeight=0,n.opened=!1,n.trfRegExp=/([-0-9.]+(?=px))/,n.trf={property:"transform",from:"",to:"translate3d(0px, 0px, 0px)",timigFunction:"ease",delay:0,duration:.5},n.fade={property:"opacity",from:"0",to:"1",timigFunction:"ease",delay:0,duration:.5},n.swipeObject={isSwipe:!1,isScroll:!1,posX1:0,posX2:0,posY1:0,posY2:0,posInitX:0,posInitY:0},n.openMenuHandler={handleEvent:n.openMenu,ctx:n},n.closeMenuHandler={handleEvent:n.closeMenu,ctx:n},n.transitionHandler={handleEvent:n.transitionEnd,ctx:n},n.swipeStartHandler={handleEvent:n.swipeStart,ctx:n},n.swipeActionHandler={handleEvent:n.swipeAction,ctx:n},n.swipeEndHandler={handleEvent:n.swipeEnd,ctx:n},n.fixHeaderHandler={handleEvent:n.fixHeader,ctx:n},n.unfixHeaderHandler={handleEvent:n.unfixHeader,ctx:n},o(n.defaults,n.options),n.init(),n.$menu},MobileMenu.prototype.init=function(){function e(e,t){return(t=t||document.body).querySelector(e)}var t,n=this,o=n.options,s=o.openButton,i=o.closeButtons,a=o.overlay,r=o.fixHeader;n.$menu=e(n.selector),s&&(n.$openButton=e(s)),i&&(n.$closeButtons=document.querySelectorAll(i)),a&&(n.$overlay=e(a)),o.allowPageScroll||(n.$fakeScrollbar=e(o.fakeScrollbar)),r&&(n.$fixHeader=e(r));var l,d=n.$menu,a=n.$overlay,r=n.$fixHeader;o.fade?(t=n.fade,o.swipe=!1):(o.toRight||o.toLeft||(o.toLeft=!0),l=o.toRight?"-100%":o.toLeft?"100%":"0px",n.trf.from="translate3d("+l+", 0px, 0px)",t=n.trf),a&&(a.style.cssText="transition:opacity .5s;opacity:0"),d.style.cssText="transition:"+t.property+" "+t.duration+"s "+t.delay+"s "+t.timigFunction+";"+t.property+":"+t.from,"none"===d.style.display&&(d.style.display=""),r&&(n.$headerClone=r.cloneNode(!0),n.$headerParent=r.parentElement,n.options.fixHeaderThreshold=r.getBoundingClientRect().bottom+pageYOffset,n.$headerClone.style.opacity=0,n.$headerClone.style.pointerEvents="none",n.fixHeader()),n.initEvents(),n.$menu.openMenu=n.openMenu,n.$menu.closeMenu=n.closeMenu,(n.$menu.ctx=n).dispatchEvent(d,"menuinit")},MobileMenu.prototype.initEvents=function(){var e=this,t=e.options,n=e.$menu,o=e.$openButton,s=e.$closeButtons,i=e.$overlay,a=!!Array.of&&{passive:!0};o.addEventListener("click",e.openMenuHandler);for(var r=0;r<s.length;r++)s[r].addEventListener("click",e.closeMenuHandler);n.addEventListener("transitionend",e.transitionHandler),t.swipe&&!t.fade&&n.addEventListener("touchstart",e.swipeStartHandler,a),t.escToClose&&document.addEventListener("keyup",e.closeMenuHandler),i&&t.overlayClick&&i.addEventListener("click",e.closeMenuHandler),e.$fixHeader&&window.addEventListener("scroll",e.fixHeaderHandler,a)},MobileMenu.prototype.openMenu=function(e){var t,n=this.ctx||this,o=n.options,s=n.$menu,i=n.$openButton,a=(n.$closeButton,n.$overlay),r=n.$fakeScrollbar,l=document.body;n.opened||(!0!==e&&n.dispatchEvent(s,"menubeforeopen"),event&&"click"===event.type&&(n.$caller=s.caller=event.target),a&&a.classList.add(o.overlayClass),i.classList.add(o.openButtonClass),s.classList.add(o.menuClass),r&&(r.classList.add(o.fakeScrollbarClass),l.classList.add(o.bodyClass),l.style.paddingRight=r.offsetWidth-r.clientWidth+"px"),n.menuWidth=s.offsetWidth,n.menuHeight=s.offsetHeight,!0!==e&&(s.scrollTop=0),t=o.fade?n.fade:n.trf,s.style.cssText="transition:"+t.property+" "+t.duration+"s "+t.delay+"s "+t.timigFunction+";"+t.property+":"+t.to,a&&(a.style.opacity=1))},MobileMenu.prototype.closeMenu=function(e){var t,n,o,s,i,a;event&&"keyup"===event.type&&27!==event.keyCode||(n=(t=this.ctx||this).options,o=t.$menu,s=t.$openButton,t.$closeButton,i=t.$overlay,t.opened&&(e||t.dispatchEvent(o,"menubeforeclose"),s.classList.remove(n.openButtonClass),a=n.fade?t.fade:t.trf,o.style.cssText="transition:"+a.property+" "+a.duration+"s "+a.delay+"s "+a.timigFunction+";"+a.property+":"+a.from,i&&(i.style.opacity=0)))},MobileMenu.prototype.swipeStart=function(){var e=this.ctx||this,t=(e.options,e.$menu),n=e.swipeObject,o=event.touches[0]||window.event.touches[0];n.isSwipe=n.isScroll=!1,n.posInitX=n.posX1=o.clientX,n.posInitY=n.posY1=o.clientY,t.addEventListener("touchend",e.swipeEndHandler),t.addEventListener("touchmove",e.swipeActionHandler),t.style.transition=""},MobileMenu.prototype.swipeAction=function(){var e,t=this.ctx||this,n=t.options,o=t.$menu,s=t.swipeObject,i=event.touches[0]||window.event.touches[0],a=+o.style.transform.match(t.trfRegExp)[0];if(s.posX2=s.posX1-i.clientX,s.posX1=i.clientX,s.posY2=s.posY1-i.clientY,s.posY1=i.clientY,s.isSwipe||s.isScroll||(e=Math.abs(s.posY2),Math.abs(s.posX2),7<e||0===s.posX2?s.isScroll=!0:e<7&&(s.isSwipe=!0)),s.isSwipe){if(n.toLeft&&s.posInitX>s.posX1)return void(o.style.transform=t.trf.to);if(n.toRight&&s.posInitX<s.posX1)return void(o.style.transform=t.trf.to);o.style.transform="translate3d("+(a-s.posX2)+"px, 0px, 0px)"}},MobileMenu.prototype.swipeEnd=function(){var e=this.ctx||this,t=e.options,n=e.$menu,o=e.swipeObject;e.trf;o.posFinal=o.posInitX-o.posX1;var s=Math.abs(o.posFinal);1<s&&o.isSwipe&&(t.toLeft&&o.posFinal<0||t.toRight&&0<o.posFinal)&&(s>=e.menuWidth*t.swipeThreshold?e.closeMenu(!0):(e.opened=!1,e.openMenu(!0))),n.removeEventListener("touchend",e.swipeEndHandler),n.removeEventListener("touchmove",e.swipeActionHandler)},MobileMenu.prototype.transitionEnd=function(){var e=this.ctx||this,t=e.options,n=e.$menu,o=(e.$openButton,e.$closeButton,e.$overlay);e.opened?(e.opened=!1,n.classList.remove(t.menuClass),o&&o.classList.remove(t.overlayClass),e.allowPageScroll(),e.dispatchEvent(n,"menuclose")):(e.opened=!0,e.dispatchEvent(n,"menuopen"))},MobileMenu.prototype.dispatchEvent=function(e,t){var n;"function"==typeof window.CustomEvent&&(n=new CustomEvent(t),e.dispatchEvent(n))},MobileMenu.prototype.allowPageScroll=function(){var e=this.ctx||this,t=e.options,n=e.$fakeScrollbar,o=document.body;n&&(o.style.paddingRight="",n.classList.remove(t.fakeScrollbarClass),o.classList.remove(t.bodyClass))},MobileMenu.prototype.fixHeader=function(){var e=this.ctx||this,t=e.options;!e.opened&&!e.$fixHeader.classList.contains(t.fixHeaderClass)&&pageYOffset>t.fixHeaderThreshold&&(e.$headerParent.appendChild(e.$headerParent.replaceChild(e.$headerClone,e.$fixHeader)),e.$fixHeader.classList.add(t.fixHeaderClass),window.removeEventListener("scroll",e.fixHeaderHandler),window.addEventListener("scroll",e.unfixHeaderHandler),e.dispatchEvent(e.$fixHeader,"headerfixed"))},MobileMenu.prototype.unfixHeader=function(){var e=this.ctx||this,t=e.options;e.$fixHeader.classList.contains(t.fixHeaderClass)&&pageYOffset<=t.fixHeaderThreshold&&(e.$headerParent.replaceChild(e.$fixHeader,e.$headerClone),e.$fixHeader.classList.remove(t.fixHeaderClass),window.removeEventListener("scroll",e.unfixHeaderHandler),window.addEventListener("scroll",e.fixHeaderHandler),e.dispatchEvent(e.$fixHeader,"headerunfixed"))},MobileMenu});